    mailout/README.md

Mailout --- простой программный пакет для организации почтовой рассылки
==========================================

`mailout` преследует следующие цели:

* организация списка получателей рассылки
* рассылка всем известным получателям писем, сгенерированных по определённому
  шаблону
* предоставление получателям возможности отказаться от рассылки
* сбор статистики по рассылке.

Список получателей хранится в [SQLite][1] базе данных.

Рассылка осуществляется из командной строки. Получатели, отказавшиеся от рассылки,
игнорируются при составлении списка получателей очередного письма.

Фиксируются следующие события:

1. Получатель открыл письмо (сработает *только* если получатель позволил
   своему почтовому клиенту загрузить изображения из письма).
2. Получатель перешёл на главную страницу сайта по ссылке из письма.
3. Получатель перешёл на страницу каталога товаров по ссылке из письма.
4. Получатель отказался от рассылки.

Для сбора статистики требуется внедрение некоторого небольшого количества 
PHP кода непосредственно на сайт. Для осуществления собственно рассылки
требуется только база получателей и шаблон письма.

Требования
==========

* PHP 5.3
* PDO
* SQLite 3
* sendmail на сервере (требуется работоспособность функции `mail`)

Установка
=========

Каталог `mailout` должен быть размещён в корневом каталоге веб-сайта.
Он должен быть доступен для чтения и записи веб-сервером.

Интеграция сбора статистики
---------------------------

В корневом каталоге `mailout` находится пять скриптов, представляющих собой 
фронт-энд.

1. `homepage_visit_trap.php`
   
   Содержит в себе кусочек PHP кода, который следует разместить на главной 
   странице сайта. Он фиксирует посещение получателями рассылки главной 
   страницы.

2. `catalog_visit_trap.php`

   Содержит в себе кусочек PHP кода, который следует разместить на странице 
   каталога товаров. Он фиксирует посещение получателями рассылки каталога.

3. `mail_open_trap.php`

   Эта страница должна быть целиком размещена по какому-либо доступному 
   из Сети URL. Она фиксирует открытие получателем рассылки самого письма.
   
   Данное событие сработает *только* если получатель позволит своему почтовому
   клиенту загрузить изображения из письма.

4. `unsubscribe.php`

   Эта страница должна быть целиком размещена по какому-либо доступному 
   из Сети URL. Она генерирует форму отказа от рассылки для получателя.

5. `stats.php`

   Эта страница должна быть целиком размещена по какому-либо доступному 
   из Сети URL. Она генерирует таблицу с текущей статистикой по рассылке.
 
Во всех вышеперечисленных скриптах следует убедиться, что пути
до бэк-энда, находящегося в файле `mailout/code/RecipientsDB_WebDriver.php`,
актуальны.

Работа со списком получателей
-----------------------------

См. `mailout/code/README.md`

Запуск рассылки
---------------

См. `mailout/app/README.md`

[1]: http://www.sqlite.org/